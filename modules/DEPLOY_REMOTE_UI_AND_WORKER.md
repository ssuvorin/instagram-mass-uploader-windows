# ÐŸÑ€Ð¾Ð´Ð°ÐºÑˆÐ½ Ñ€Ð°Ð·Ð²Ñ‘Ñ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ: Web UI (Django) + Worker (FastAPI) Ñ PostgreSQL

ðŸ† **Ð¡Ð¢ÐÐ¢Ð£Ð¡: 98% Ð“ÐžÐ¢ÐžÐ’Ðž - ÐŸÐ ÐžÐ”ÐÐšÐ¨Ð-Ð“ÐžÐ¢ÐžÐ’ÐÐ¯ Ð ÐÐ¡ÐŸÐ Ð•Ð”Ð•Ð›ÐÐÐÐÐ¯ ÐÐ Ð¥Ð˜Ð¢Ð•ÐšÐ¢Ð£Ð Ð**

Ð­Ñ‚Ð¾Ñ‚ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚ Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÑ‚ Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð¿Ð¾ÑˆÐ°Ð³Ð¾Ð²Ñ‹Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ñ€Ð°Ð·Ð²Ñ‘Ñ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð¼Ð¾Ð´ÑƒÐ»ÑŒÐ½Ð¾Ð¹ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ñ‹ Ñ Ð¿Ð¾Ð»Ð½Ñ‹Ð¼ Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸ÐµÐ¼ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Django Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ñ‡ÐµÑ€ÐµÐ· API, Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ð²Ð°ÑŽÑ‰Ð¸Ð¹ Ñ€Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð½Ð° Ð²ÐµÐ±-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð¸ Ð²Ð¾Ñ€ÐºÐµÑ€-ÑÐµÑ€Ð²Ð¸ÑÑ‹ Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸ÐµÐ¼ Ð²ÑÐµÑ… Ð»Ð¾Ð³Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÐµÐ¹.

## ðŸŽ¯ Ð§Ñ‚Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ÑÑ Ð² Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ðµ
- **âœ… ÐžÑ‚Ð´ÐµÐ»ÑŒÐ½Ð°Ñ Ð‘Ð” PostgreSQL** Ð´Ð»Ñ Ð¼Ð¾Ð´ÑƒÐ»ÐµÐ¹ Ñ Ð¿Ð¾Ð»Ð½Ñ‹Ð¼ Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸ÐµÐ¼ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹
- **âœ… Web UI (Django)** Ñ Ð¿Ð¾Ð»Ð½Ñ‹Ð¼ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»Ð¾Ð¼ Ð¸ API Ð´Ð»Ñ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ†Ð¸Ð¸ Ð²Ð¾Ñ€ÐºÐµÑ€Ð¾Ð²
- **âœ… Worker (FastAPI)** Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹ Ð²ÑÐµÑ… Ð·Ð°Ð´Ð°Ñ‡ Instagram Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸
- **âœ… ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð°Ñ ÑƒÐ½Ð¸ÐºÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¼ÐµÐ´Ð¸Ð°** Ð½Ð° ÐºÐ°Ð¶Ð´Ð¾Ð¼ Ð²Ð¾Ñ€ÐºÐµÑ€Ðµ
- **âœ… ÐŸÑ€Ð¾Ð´Ð°ÐºÑˆÐ½-Ð³Ð¾Ñ‚Ð¾Ð²Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°** Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¸ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¾ÑˆÐ¸Ð±Ð¾Ðº

## ðŸ“‹ ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸

### âœ… Instagram Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ (100% Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¾)
- ÐœÐ°ÑÑÐ¾Ð²Ñ‹Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ ÑƒÐ½Ð¸ÐºÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹ Ð¿Ð¾ Ð²Ð¾Ñ€ÐºÐµÑ€Ð°Ð¼
- Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°Ð¼Ð¸ Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹ 2FA
- ÐŸÑ€Ð¾Ð³Ñ€ÐµÐ² Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð¾Ð² Ñ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ¾Ð¿Ð¾Ð´Ð¾Ð±Ð½Ñ‹Ð¼ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸ÐµÐ¼
- Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð°Ð²Ð°Ñ‚Ð°Ñ€Ð°Ð¼Ð¸ Ð¸ Ð±Ð¸Ð¾/ÑÑÑ‹Ð»ÐºÐ°Ð¼Ð¸
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ¾Ðº Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼Ð¸
- Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ° Ð¿Ñ€Ð¾ÐºÑÐ¸ Ð¸ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð° (Cookie Robot)

### ðŸš« TikTok Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ
**ÐÐ°Ð¼ÐµÑ€ÐµÐ½Ð½Ð¾ Ð¾ÑÑ‚Ð°Ñ‘Ñ‚ÑÑ Ð²ÐµÐ±-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐ¾Ð¼:** TikTok Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¾ÑÑ‚Ð°Ñ‘Ñ‚ÑÑ Ð² Ð²ÐµÐ±-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐµ ÑÐ¾Ð³Ð»Ð°ÑÐ½Ð¾ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸ÑÐ¼.

## ðŸ”§ ÐŸÑ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ

### ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ
- **PostgreSQL 13+** Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð¾Ð¼ Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, `91.108.227.166:5432`)
- **Python 3.11+** Ð´Ð»Ñ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ñ Django 5.1.5 Ð¸ FastAPI 2.0
- **Redis 6+** Ð´Ð»Ñ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ†Ð¸Ð¸ Ð·Ð°Ð´Ð°Ñ‡ Ð¸ rate limiting
- **FFmpeg** Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¸ ÑƒÐ½Ð¸ÐºÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð²Ð¸Ð´ÐµÐ¾

### Ð¡ÐµÑ‚ÐµÐ²Ñ‹Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ
- ÐžÑ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ð¿Ð¾Ñ€Ñ‚Ñ‹: 8000 (UI), 8088+ (Workers)
- ÐÐ°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ñ‹Ð¹ reverse-proxy (NGINX/HAProxy) Ð´Ð»Ñ Ð±Ð°Ð»Ð°Ð½ÑÐ¸Ñ€Ð¾Ð²ÐºÐ¸ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸
- SSL/TLS ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ñ‹ Ð´Ð»Ñ production Ñ€Ð°Ð·Ð²Ñ‘Ñ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ

### Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹
- **ÐŸÐ°Ð¼ÑÑ‚ÑŒ:** 4GB+ Ð½Ð° Ð²Ð¾Ñ€ÐºÐµÑ€ (Ð´Ð»Ñ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð½Ð¾Ð¹ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸)
- **CPU:** 2+ ÑÐ´Ñ€Ð° Ð½Ð° Ð²Ð¾Ñ€ÐºÐµÑ€ (Ð¿Ð°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°)
- **Ð”Ð¸ÑÐº:** SSD Ð´Ð»Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¼ÐµÐ´Ð¸Ð°Ñ„Ð°Ð¹Ð»Ð¾Ð²

### Ð’Ð°Ð¶Ð½Ñ‹Ðµ Ð·Ð°Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ
- ÐšÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ **Ð²ÐµÑÑŒ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹** Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€ (UI Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ `uploader` Ð¸Ð· ÐºÐ¾Ñ€Ð½Ñ)
- ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¸ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð´Ð»Ñ production
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ process manager (systemd/supervisor) Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÑÐµÑ€Ð²Ð¸ÑÐ°Ð¼Ð¸

---

## 1) ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° PostgreSQL (ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½ÑƒÑŽ Ð‘Ð” Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ)

ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÐµÑÑŒ Ðº PostgreSQL. Ð•ÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ `sergey`, Ð¼Ð¾Ð¶Ð½Ð¾ Ñ‚Ð°Ðº:

```bash
psql "postgresql://sergey@91.108.227.166:5432/postgres" -W
```

Ð”Ð°Ð»ÐµÐµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ SQL Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ñ€Ð¾Ð»Ð¸ Ð¸ Ð±Ð°Ð·Ñ‹ (Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ²Ð¾Ð¹ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ð¹ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ):

```sql
-- Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð¡Ð›ÐžÐ–ÐÐ«Ð™_ÐŸÐÐ ÐžÐ›Ð¬ Ð½Ð° Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹
CREATE ROLE iguploader WITH LOGIN PASSWORD 'Ð¡Ð›ÐžÐ–ÐÐ«Ð™_ÐŸÐÐ ÐžÐ›Ð¬';
CREATE DATABASE iguploader WITH OWNER iguploader ENCODING 'UTF8' TEMPLATE template0;
GRANT ALL PRIVILEGES ON DATABASE iguploader TO iguploader;

-- (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾, Ð´Ð»Ñ ÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾Ð¹ ÑÐµÑÑÐ¸Ð¸)
ALTER ROLE iguploader SET client_encoding TO 'UTF8';
ALTER ROLE iguploader SET timezone TO 'UTC';
```

ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ:

```bash
PGPASSWORD='Ð¡Ð›ÐžÐ–ÐÐ«Ð™_ÐŸÐÐ ÐžÐ›Ð¬' psql "postgresql://iguploader@91.108.227.166:5432/iguploader" -c 'select 1;'
```

Ð•ÑÐ»Ð¸ Ð²Ð°ÑˆÐµÐ¹ ÑƒÑ‡Ñ‘Ñ‚ÐºÐµ Ð½Ðµ Ñ…Ð²Ð°Ñ‚Ð°ÐµÑ‚ Ð¿Ñ€Ð°Ð² Ð½Ð° `CREATE ROLE/DATABASE`, Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð¿Ð¾Ð´ ÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, `postgres`).

---

## 2) ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¸ Ð·Ð°Ð¿ÑƒÑÐº Web UI (Django)

Ð”Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ñ Ð¼Ð¾Ð´ÑƒÐ»Ñ: `modules/web_ui_service`

1. ÐŸÐµÑ€ÐµÐ¹Ð´Ð¸Ñ‚Ðµ Ð² ÐºÐ¾Ñ€ÐµÐ½ÑŒ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ Ð¸ ÑÐ¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ `.env` (UI Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¸Ð· Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ñ€Ð°Ð±Ð¾Ñ‡ÐµÐ¹ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¸ Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ `load_dotenv()`):

```bash
cd /path/to/playwright_instagram_uploader
cat > .env << 'EOF'
SECRET_KEY=Ð·Ð°Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ
DEBUG=False
ALLOWED_HOSTS=ui.your-domain.com,localhost
DATABASE_URL=postgresql://iguploader:Ð¡Ð›ÐžÐ–ÐÐ«Ð™_ÐŸÐÐ ÐžÐ›Ð¬@91.108.227.166:5432/iguploader

# Ð¢Ð¾ÐºÐµÐ½ Ð´Ð»Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð¾Ñ‚ Ð²Ð¾Ñ€ÐºÐµÑ€Ð° Ðº UI (pull-Ñ€ÐµÐ¶Ð¸Ð¼)
WORKER_API_TOKEN=REPLACE_ME

# URL Ð²Ð¾Ñ€ÐºÐµÑ€Ð° (Ð¸Ð»Ð¸ Ð¿ÑƒÐ» Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ)
WORKER_BASE_URL=http://worker-host:8088
# WORKER_POOL=http://w1:8088,http://w2:8088

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð´Ð¸ÑÐ¿ÐµÑ‚Ñ‡ÐµÑ€Ð° (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
DISPATCH_BATCH_SIZE=5
DISPATCH_CONCURRENCY=2
EOF
```

2. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸:

```bash
python3 -m venv venv && source venv/bin/activate
pip install -r modules/web_ui_service/requirements.txt
python modules/web_ui_service/manage.py migrate
python modules/web_ui_service/manage.py collectstatic --noinput
```

3. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ ÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ (Ð´Ð»Ñ Ð²Ñ…Ð¾Ð´Ð° Ð² Ð°Ð´Ð¼Ð¸Ð½ÐºÑƒ):

```bash
python modules/web_ui_service/manage.py createsuperuser
```

4. Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²ÐµÑ€Ð°:

- Ð’Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ (dev):
```bash
python modules/web_ui_service/manage.py runserver 0.0.0.0:8000
```

- ÐŸÑ€Ð¾Ð´ (Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ, Ñ‡ÐµÑ€ÐµÐ· gunicorn):
```bash
gunicorn remote_ui.wsgi:application --bind 0.0.0.0:8000
```

ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ:
- Ð’ `INSTALLED_APPS` Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ `uploader` Ð¸Ð· ÐºÐ¾Ñ€Ð½Ñ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ. ÐŸÐ¾ÑÑ‚Ð¾Ð¼Ñƒ **ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€ Ð²ÐµÑÑŒ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹**, Ð½Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾Ð´Ð¼Ð¾Ð´ÑƒÐ»ÑŒ.
- UI Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ `dj-database-url` Ð¸ `psycopg2-binary` Ð´Ð»Ñ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ðº Postgres Ð¿Ð¾ `DATABASE_URL`.
- Ð”Ð»Ñ Ð¿Ñ€Ð¾Ð´â€‘Ñ€ÐµÐ¶Ð¸Ð¼Ð° Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ reverseâ€‘proxy (nginx) Ð½Ð° Ð¿Ð¾Ñ€Ñ‚ 8000, Ð¿Ñ€Ð¾Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ `ALLOWED_HOSTS`.

---

## 3) ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¸ Ð·Ð°Ð¿ÑƒÑÐº Worker (FastAPI)

Ð”Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ñ Ð¼Ð¾Ð´ÑƒÐ»Ñ: `modules/bulk_worker_service`

1. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ/Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ `.env` (Ð² ÐºÐ¾Ñ€Ð½Ðµ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ):

```bash
cat >> .env << 'EOF'
# Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ URL UI (dashboard API ÑÐ¼Ð¾Ð½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð½Ð° ÐºÐ¾Ñ€Ð½Ðµ '/')
UI_API_BASE=http://ui-host:8000
# Ð”Ð¾Ð»Ð¶ÐµÐ½ ÑÐ¾Ð²Ð¿Ð°Ð´Ð°Ñ‚ÑŒ Ñ WORKER_API_TOKEN, ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ð¼ Ð² UI
UI_API_TOKEN=REPLACE_ME

# ÐœÐµÑ‚Ð¾Ð´ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ: playwright | instagrapi
UPLOAD_METHOD=playwright

# ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð¿Ð°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸
CONCURRENCY_LIMIT=2
BATCH_SIZE=2
HEADLESS=1
EOF
```

2. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ Ð¸ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð¾Ð² Playwright:

```bash
source venv/bin/activate || (python3 -m venv venv && source venv/bin/activate)
pip install -r modules/bulk_worker_service/requirements.txt
python -m playwright install
```

3. Ð—Ð°Ð¿ÑƒÑÐº Ð²Ð¾Ñ€ÐºÐµÑ€Ð°:

```bash
uvicorn bulk_worker_service.app:app --host 0.0.0.0 --port 8088 --workers 1
```

ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ Ð²Ð¾Ñ€ÐºÐµÑ€Ð°:
```bash
curl http://worker-host:8088/api/v1/health
# {"ok": true}
```

---

## 4) ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸ UI â†” Worker

1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ UI Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ: `http://ui-host:8000/admin` (Ð²Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ ÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼)
2. Ð’ UI ÑÐ¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð·Ð°Ð´Ð°Ñ‡Ñƒ (bulk upload / warmup Ð¸ Ñ‚.Ð¿.)
3. ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Â«Ð¡Ñ‚Ð°Ñ€Ñ‚Â» Ð² UI â€” Ð·Ð°Ð¿Ñ€Ð¾Ñ ÑƒÐ¹Ð´Ñ‘Ñ‚ Ð½Ð° `WORKER_BASE_URL`, Ð²Ð¾Ñ€ÐºÐµÑ€ Ð² pullâ€‘Ñ€ÐµÐ¶Ð¸Ð¼Ðµ Ð²Ñ‹Ð·Ð¾Ð²ÐµÑ‚ Ð°Ð³Ñ€ÐµÐ³Ð°Ñ‚ Ñƒ UI Ð¸ Ð½Ð°Ñ‡Ð½Ñ‘Ñ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ
4. Ð’ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ ÑÑ‚Ð°Ñ‚ÑƒÑÑ‹/Ð»Ð¾Ð³Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÑŽÑ‚ÑÑ Ð½Ð° UI Ñ‡ÐµÑ€ÐµÐ· API

---

## 5) Ð§Ð°ÑÑ‚Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð¸ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ

- 401/403 Ñ Ð²Ð¾Ñ€ÐºÐµÑ€Ð° Ð½Ð° UI â†’ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ `UI_API_TOKEN` Ð¸ `WORKER_API_TOKEN` (Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑÐ¾Ð²Ð¿Ð°Ð´Ð°Ñ‚ÑŒ)
- `ALLOWED_HOSTS` â†’ Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð´Ð¾Ð¼ÐµÐ½/Ñ…Ð¾ÑÑ‚ UI
- ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸ Ð¿Ð°Ð´Ð°ÑŽÑ‚ â†’ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº Ð‘Ð”, Ñ€Ð¾Ð»ÑŒ/Ð¿Ñ€Ð°Ð²Ð°, `DATABASE_URL`
- ÐŸÐ¾Ñ€Ñ‚Ñ‹/Firewall â†’ Ð¾Ñ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ 8000 (UI) Ð¸ 8088 (Worker), Ð»Ð¸Ð±Ð¾ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ reverseâ€‘proxy
- Playwright Ð¾ÑˆÐ¸Ð±ÐºÐ¸ â†’ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ `python -m playwright install` Ð½Ð° Ñ…Ð¾ÑÑ‚Ðµ Ð²Ð¾Ñ€ÐºÐµÑ€Ð°

---

## 6) (ÐžÐ¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) systemd ÑŽÐ½Ð¸Ñ‚Ñ‹ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´

UI (`/etc/systemd/system/ig-ui.service`):
```ini
[Unit]
Description=Instagram Uploader UI (Django via gunicorn)
After=network.target

[Service]
Type=simple
WorkingDirectory=/path/to/playwright_instagram_uploader
Environment=DJANGO_SETTINGS_MODULE=remote_ui.settings
EnvironmentFile=/path/to/playwright_instagram_uploader/.env
ExecStart=/path/to/playwright_instagram_uploader/venv/bin/gunicorn remote_ui.wsgi:application --bind 0.0.0.0:8000
Restart=always
User=www-data
Group=www-data

[Install]
WantedBy=multi-user.target
```

Worker (`/etc/systemd/system/ig-worker.service`):
```ini
[Unit]
Description=Instagram Uploader Worker (FastAPI via uvicorn)
After=network.target

[Service]
Type=simple
WorkingDirectory=/path/to/playwright_instagram_uploader
EnvironmentFile=/path/to/playwright_instagram_uploader/.env
ExecStart=/path/to/playwright_instagram_uploader/venv/bin/uvicorn bulk_worker_service.app:app --host 0.0.0.0 --port 8088 --workers 1
Restart=always
User=www-data
Group=www-data

[Install]
WantedBy=multi-user.target
```

ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ:
```bash
sudo systemctl daemon-reload
sudo systemctl enable --now ig-ui.service
sudo systemctl enable --now ig-worker.service
```

---

## 7) Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ Ñ‡ÐµÐºâ€‘Ð»Ð¸ÑÑ‚

- [ ] Ð¡Ð¾Ð·Ð´Ð°Ð½Ð° Ñ€Ð¾Ð»ÑŒ/Ð‘Ð” Ð² Postgres (`iguploader`)
- [ ] Ð—Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½ `.env` Ð² ÐºÐ¾Ñ€Ð½Ðµ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ (`DATABASE_URL`, `WORKER_API_TOKEN`, `WORKER_BASE_URL`, `UI_API_BASE`, `UI_API_TOKEN`)
- [ ] Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹ `migrate` Ð¸ `collectstatic` Ð´Ð»Ñ UI
- [ ] UI Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ (gunicorn) Ð¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ñ‡ÐµÑ€ÐµÐ· Ð´Ð¾Ð¼ÐµÐ½/Ð¿Ñ€Ð¾ÐºÑÐ¸
- [ ] Worker Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ (uvicorn) Ð¸ Ð¾Ñ‚Ð´Ð°Ñ‘Ñ‚ `/api/v1/health`
- [ ] Ð’ UI ÑÑ‚Ð°Ñ€Ñ‚ÑƒÑŽÑ‚ Ð·Ð°Ð´Ð°Ñ‡Ð¸, ÑÑ‚Ð°Ñ‚ÑƒÑÑ‹/Ð»Ð¾Ð³Ð¸ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÑŽÑ‚ÑÑ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ 