{% extends "uploader/yt_base.html" %}

{% block title %}{{ account.email }} - YouTube Account Details{% endblock %}

{% block extra_css %}
<style>
	/* YouTube-inspired styling */
	:root {
		--yt-red: #ff0000;
		--yt-dark-red: #cc0000;
		--yt-light-gray: #f9f9f9;
		--yt-gray: #606060;
		--yt-border: #e0e0e0;
	}
	
	.btn-yt-primary {
		background-color: var(--yt-red);
		border-color: var(--yt-red);
		color: white;
	}
	.btn-yt-primary:hover {
		background-color: var(--yt-dark-red);
		border-color: var(--yt-dark-red);
		color: white;
	}
	
	.info-card {
		background: white;
		border: 1px solid var(--yt-border);
		border-radius: 8px;
		transition: box-shadow 0.2s ease;
	}
	.info-card:hover {
		box-shadow: 0 2px 8px rgba(0,0,0,0.1);
	}
	
	.status-badge {
		font-size: 0.875rem;
		padding: 0.5rem 1rem;
		border-radius: 20px;
		font-weight: 500;
	}
	
	.status-active { 
		background: rgba(16, 185, 129, 0.1); 
		color: #10b981; 
		border: 1px solid rgba(16, 185, 129, 0.2); 
	}
	.status-blocked { 
		background: rgba(239, 68, 68, 0.1); 
		color: #ef4444; 
		border: 1px solid rgba(239, 68, 68, 0.2); 
	}
	.status-limited { 
		background: rgba(245, 158, 11, 0.1); 
		color: #f59e0b; 
		border: 1px solid rgba(245, 158, 11, 0.2); 
	}
	.status-inactive { 
		background: rgba(107, 114, 128, 0.1); 
		color: #6b7280; 
		border: 1px solid rgba(107, 114, 128, 0.2); 
	}
</style>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
	<div>
		<a href="{% url 'yt_accounts_list' %}" class="text-decoration-none">
			<i class="bi bi-arrow-left"></i> Back to YouTube Accounts
		</a>
		<h2 class="mb-0 mt-2">
			<i class="bi bi-youtube text-danger me-2"></i>{{ account.email }}
		</h2>
	</div>
	<div>
		<div class="btn-group" role="group">
			<a href="{% url 'yt_account_edit' account.id %}" class="btn btn-outline-secondary">
				<i class="bi bi-pencil"></i> Edit
			</a>
			<a href="{% url 'yt_account_delete' account.id %}" class="btn btn-outline-danger" onclick="return confirm('Are you sure you want to delete this account?')">
				<i class="bi bi-trash"></i> Delete
			</a>
		</div>
	</div>
</div>

<div class="row">
	<!-- Account Information -->
	<div class="col-md-8">
		<div class="info-card p-4 mb-4">
			<h5 class="mb-3">
				<i class="bi bi-person-circle text-primary me-2"></i>Account Information
			</h5>
			
			<div class="row">
				<div class="col-md-6 mb-3">
					<label class="form-label text-muted">Email</label>
					<div class="fw-medium">{{ account.email }}</div>
				</div>
				<div class="col-md-6 mb-3">
					<label class="form-label text-muted">Status</label>
					<div>
						<span class="status-badge status-{{ account.status|lower }}">
							{{ account.get_status_display }}
						</span>
					</div>
				</div>
			</div>
			
			<div class="row">
				<div class="col-md-6 mb-3">
					<label class="form-label text-muted">Channel Name</label>
					<div class="fw-medium">
						{% if account.channel_name %}
							{{ account.channel_name }}
						{% else %}
							<span class="text-muted">Not set</span>
						{% endif %}
					</div>
				</div>
				<div class="col-md-6 mb-3">
					<label class="form-label text-muted">Channel ID</label>
					<div class="fw-medium">
						{% if account.channel_id %}
							<code>{{ account.channel_id }}</code>
						{% else %}
							<span class="text-muted">Not set</span>
						{% endif %}
					</div>
				</div>
			</div>
			
			<div class="row">
				<div class="col-md-6 mb-3">
					<label class="form-label text-muted">Recovery Email</label>
					<div class="fw-medium">
						{% if account.recovery_email %}
							{{ account.recovery_email }}
						{% else %}
							<span class="text-muted">Not set</span>
						{% endif %}
					</div>
				</div>
				<div class="col-md-6 mb-3">
					<label class="form-label text-muted">Phone Number</label>
					<div class="fw-medium">
						{% if account.phone_number %}
							{{ account.phone_number }}
						{% else %}
							<span class="text-muted">Not set</span>
						{% endif %}
					</div>
				</div>
			</div>
			
			<div class="row">
				<div class="col-md-6 mb-3">
					<label class="form-label text-muted">Locale</label>
					<div class="fw-medium">
						<span class="badge bg-light text-dark">{{ account.locale }}</span>
					</div>
				</div>
				<div class="col-md-6 mb-3">
					<label class="form-label text-muted">2FA Secret</label>
					<div class="fw-medium">
						{% if account.tfa_secret %}
							<span class="text-success">
								<i class="bi bi-check-circle-fill"></i> Configured
							</span>
						{% else %}
							<span class="text-muted">Not configured</span>
						{% endif %}
					</div>
				</div>
			</div>
			
			{% if account.notes %}
			<div class="row">
				<div class="col-12 mb-3">
					<label class="form-label text-muted">Notes</label>
					<div class="fw-medium">{{ account.notes|linebreaks }}</div>
				</div>
			</div>
			{% endif %}
		</div>
		
		<!-- Recent Uploads -->
		<div class="info-card p-4">
			<h5 class="mb-3">
				<i class="bi bi-upload text-success me-2"></i>Recent Upload Activity
			</h5>
			
			{% if recent_uploads %}
			<div class="table-responsive">
				<table class="table table-sm">
					<thead>
						<tr>
							<th>Task</th>
							<th>Status</th>
							<th>Success</th>
							<th>Failed</th>
							<th>Started</th>
							<th>Completed</th>
						</tr>
					</thead>
					<tbody>
						{% for upload in recent_uploads %}
						<tr>
							<td>
								<a href="{% url 'yt_shorts_bulk_upload_detail' upload.bulk_task.id %}" class="text-decoration-none">
									{{ upload.bulk_task.name|truncatechars:30 }}
								</a>
							</td>
							<td>
								<span class="badge bg-{% if upload.status == 'COMPLETED' %}success{% elif upload.status == 'FAILED' %}danger{% elif upload.status == 'RUNNING' %}primary{% else %}secondary{% endif %}">
									{{ upload.get_status_display }}
								</span>
							</td>
							<td class="text-success">{{ upload.uploaded_success_count }}</td>
							<td class="text-danger">{{ upload.uploaded_failed_count }}</td>
							<td>
								{% if upload.started_at %}
									<small class="text-muted">{{ upload.started_at|date:"M d, H:i" }}</small>
								{% else %}
									<span class="text-muted">-</span>
								{% endif %}
							</td>
							<td>
								{% if upload.completed_at %}
									<small class="text-muted">{{ upload.completed_at|date:"M d, H:i" }}</small>
								{% else %}
									<span class="text-muted">-</span>
								{% endif %}
							</td>
						</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
			{% else %}
			<div class="text-center text-muted py-4">
				<i class="bi bi-inbox fs-1 d-block mb-2"></i>
				No upload activity yet
			</div>
			{% endif %}
		</div>
	</div>
	
	<!-- Sidebar -->
	<div class="col-md-4">
		<!-- Statistics -->
		<div class="info-card p-4 mb-4">
			<h6 class="mb-3">
				<i class="bi bi-graph-up text-primary me-2"></i>Statistics
			</h6>
			
			<div class="row text-center">
				<div class="col-6 mb-3">
					<div class="h4 text-success mb-1">{{ total_success }}</div>
					<small class="text-muted">Successful Uploads</small>
				</div>
				<div class="col-6 mb-3">
					<div class="h4 text-danger mb-1">{{ total_failed }}</div>
					<small class="text-muted">Failed Uploads</small>
				</div>
			</div>
		</div>
		
		<!-- Proxy Information -->
		<div class="info-card p-4 mb-4">
			<h6 class="mb-3">
				<i class="bi bi-shield-lock text-warning me-2"></i>Proxy Information
			</h6>
			
			{% if account.proxy %}
			<div class="mb-2">
				<label class="form-label text-muted small">Proxy</label>
				<div class="fw-medium">{{ account.proxy.host }}:{{ account.proxy.port }}</div>
			</div>
			<div class="mb-2">
				<label class="form-label text-muted small">Type</label>
				<div class="fw-medium">{{ account.proxy.get_proxy_type_display }}</div>
			</div>
			<div class="mb-2">
				<label class="form-label text-muted small">Status</label>
				<div>
					<span class="badge bg-{% if account.proxy.is_active %}success{% else %}danger{% endif %}">
						{{ account.proxy.get_status_display }}
					</span>
				</div>
			</div>
			{% if account.proxy.country %}
			<div class="mb-2">
				<label class="form-label text-muted small">Location</label>
				<div class="fw-medium">{{ account.proxy.country }}{% if account.proxy.city %}, {{ account.proxy.city }}{% endif %}</div>
			</div>
			{% endif %}
			{% else %}
			<div class="text-center text-muted py-2">
				<i class="bi bi-shield-x fs-4 d-block mb-2"></i>
				No proxy assigned
			</div>
			{% endif %}
		</div>
		
		<!-- Dolphin Profile -->
		<div class="info-card p-4 mb-4">
			<h6 class="mb-3">
				<i class="bi bi-browser-chrome text-info me-2"></i>Dolphin Profile
			</h6>
			
			{% if account.dolphin_profile_id %}
			<div class="mb-2">
				<label class="form-label text-muted small">Profile ID</label>
				<div class="fw-medium">
					<code>{{ account.dolphin_profile_id }}</code>
				</div>
			</div>
			{% else %}
			<div class="text-center text-muted py-2">
				<i class="bi bi-browser-safari fs-4 d-block mb-2"></i>
				No Dolphin profile
			</div>
			{% endif %}
		</div>
		
		<!-- Account Timeline -->
		<div class="info-card p-4">
			<h6 class="mb-3">
				<i class="bi bi-clock-history text-secondary me-2"></i>Timeline
			</h6>
			
			<div class="timeline">
				<div class="timeline-item mb-3">
					<div class="timeline-marker bg-primary"></div>
					<div class="timeline-content">
						<div class="fw-medium">Account Created</div>
						<small class="text-muted">{{ account.created_at|date:"M d, Y H:i" }}</small>
					</div>
				</div>
				
				{% if account.last_used %}
				<div class="timeline-item mb-3">
					<div class="timeline-marker bg-success"></div>
					<div class="timeline-content">
						<div class="fw-medium">Last Used</div>
						<small class="text-muted">{{ account.last_used|date:"M d, Y H:i" }}</small>
					</div>
				</div>
				{% endif %}
				
				<div class="timeline-item">
					<div class="timeline-marker bg-secondary"></div>
					<div class="timeline-content">
						<div class="fw-medium">Last Updated</div>
						<small class="text-muted">{{ account.updated_at|date:"M d, Y H:i" }}</small>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{% block extra_js %}
<style>
.timeline {
	position: relative;
	padding-left: 2rem;
}

.timeline::before {
	content: '';
	position: absolute;
	left: 0.75rem;
	top: 0;
	bottom: 0;
	width: 2px;
	background: var(--yt-border);
}

.timeline-item {
	position: relative;
}

.timeline-marker {
	position: absolute;
	left: -2rem;
	top: 0.25rem;
	width: 0.75rem;
	height: 0.75rem;
	border-radius: 50%;
	border: 2px solid white;
	box-shadow: 0 0 0 2px var(--yt-border);
}

.timeline-content {
	padding-left: 0.5rem;
}
</style>
{% endblock %}
