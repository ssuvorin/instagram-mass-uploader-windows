# Массовые действия с аккаунтами Instagram

## Обзор

Добавлена функциональность массовых действий на странице списка аккаунтов `/accounts/`.

## Что добавлено

### 1. Чекбоксы для выбора аккаунтов
- **Чекбокс "Выбрать все"** в заголовке таблицы
- **Индивидуальные чекбоксы** для каждого аккаунта
- Визуальное выделение выбранных строк (синий фон)
- Поддержка состояния "indeterminate" (частичный выбор)

### 2. Плавающая панель массовых действий
Появляется внизу экрана при выборе хотя бы одного аккаунта:
- Показывает количество выбранных аккаунтов
- Содержит кнопки массовых действий
- Анимированное появление/скрытие

### 3. Доступные массовые действия

#### **Save Snapshots** (Сохранить снимки)
- Получает и сохраняет полные снимки профилей Dolphin из API
- Работает только с аккаунтами, у которых есть `dolphin_profile_id`
- Показывает статистику: успешно/ошибки/пропущено

**URL:** `POST /accounts/bulk-save-snapshots/`

#### **Change Proxy** (Изменить прокси)
- Перенаправляет на существующую страницу массовой смены прокси
- Передает выбранные ID аккаунтов через query параметры

**URL:** `GET /accounts/bulk-change-proxy/?account_ids=1,2,3`

#### **Change Status** (Изменить статус)
- Массовое изменение статуса аккаунтов
- Поддерживаемые статусы:
  - ACTIVE
  - BLOCKED
  - LIMITED
  - INACTIVE
  - PHONE_VERIFICATION_REQUIRED
  - HUMAN_VERIFICATION_REQUIRED
  - SUSPENDED

**URL:** `POST /accounts/bulk-change-status/`

#### **Delete** (Удалить)
- Массовое удаление выбранных аккаунтов
- Требует подтверждение
- Необратимое действие

**URL:** `POST /accounts/bulk-delete/`

## Технические детали

### Frontend
**Файл:** `uploader/templates/uploader/account_list.html`

- Добавлены чекбоксы в таблицу
- JavaScript для управления выбором
- Динамическая панель массовых действий
- Функции отправки форм с CSRF защитой

### Backend
**Файл:** `uploader/views_mod/accounts.py`

Новые view-функции:
- `bulk_save_snapshots()` - сохранение снимков
- `bulk_change_status()` - смена статуса
- `bulk_delete_accounts()` - удаление

### URLs
**Файл:** `uploader/urls.py`

```python
path('accounts/bulk-save-snapshots/', views.bulk_save_snapshots, name='bulk_save_snapshots'),
path('accounts/bulk-change-status/', views.bulk_change_status, name='bulk_change_status'),
path('accounts/bulk-delete/', views.bulk_delete_accounts, name='bulk_delete_accounts'),
```

## Использование

### Выбор аккаунтов
1. Откройте страницу `/accounts/`
2. Отметьте нужные аккаунты чекбоксами
3. Или используйте чекбокс в заголовке для выбора всех

### Выполнение действий
1. Выберите аккаунты
2. Внизу экрана появится панель действий
3. Нажмите нужную кнопку
4. Подтвердите действие (если требуется)

### Отмена выбора
- Нажмите кнопку **Cancel** на панели действий
- Или снимите все чекбоксы вручную

## Безопасность

- Все действия требуют аутентификации (`@login_required`)
- CSRF защита для POST запросов
- Подтверждение для опасных операций (удаление)
- Логирование всех массовых операций

## Логи

Все массовые действия логируются с префиксами:
- `[BULK SNAPSHOT]` - сохранение снимков
- `[BULK STATUS]` - изменение статуса
- `[BULK DELETE]` - удаление аккаунтов

Пример:
```
[2025-10-01 16:00:00] INFO [BULK SNAPSHOT] Successfully saved snapshot for user123
[2025-10-01 16:00:01] INFO [BULK STATUS] Changed status to ACTIVE for 5 account(s)
[2025-10-01 16:00:02] INFO [BULK DELETE] Deleted 3 account(s): user1, user2, user3
```

## UI/UX особенности

### Визуальные эффекты
- Плавная анимация появления панели действий
- Выделение выбранных строк синим цветом
- Счетчик выбранных аккаунтов

### Адаптивность
- Панель действий адаптируется под ширину экрана
- Минимальная ширина 600px для удобства

### Состояния чекбокса "Выбрать все"
- ☐ Не выбрано ничего
- ☑ Выбраны все
- ⊟ Выбраны некоторые (indeterminate)

## Примеры использования

### Сохранить снимки для всех аккаунтов с профилями
1. Нажмите чекбокс "Выбрать все"
2. Нажмите "Save Snapshots"
3. Подтвердите действие
4. Система обработает каждый аккаунт и покажет статистику

### Удалить несколько неактивных аккаунтов
1. Примените фильтр по статусу INACTIVE
2. Выберите нужные аккаунты
3. Нажмите "Delete"
4. Подтвердите удаление

### Изменить статус заблокированных аккаунтов
1. Примените фильтр BLOCKED
2. Выберите аккаунты
3. Нажмите "Change Status"
4. Введите новый статус (например, SUSPENDED)

